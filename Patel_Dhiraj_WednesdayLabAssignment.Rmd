---
title: "Lab Assignment Wednesday"
author: "Dhiraj Patel"
date: "11/13/2018"
output: html_document
---

```{r}
#assign pO2 values

# NUMBER 1: plot experimental data and simulation run assuming independent binding. 

#SIMULATION DATA EQUATION


experimental<-read.csv("Experimental_Data.csv")
temp <- read.csv("Temp_data_Exp.csv")

pO2ValuesExp <- experimental$data_pO2
SaturationValuesExp <- experimental$data_Y

k <- (1/10) #torr ^-1 
pO2values <- seq(0,105,0.01)

yVal <- function(pO2){
  toppart <- ((pO2*k)+(3*((pO2^2)*(k^2)))+(3*((pO2^3)*(k^3)))+((pO2^4)*(k^4)))
  botpart <- (1+(4*(pO2*k))+(6*((pO2^2)*(k^2)))+(4*((pO2^3)*(k^3)))+((pO2^4)*(k^4)))
  ans <- (toppart/botpart)
  return(ans)
}
# #PLOT THE SIMULATION DATA. EQUATION THAT YOU PROGRAM AND SOLVE FOR. 
# plot(pO2values,yVal(pO2values),main="Independent Binding Experimental Data Hemoglobin Curve",xlab="pO2 mmHg",ylab="hemoglobin saturation %",col=c(3))
# lines(pO2ValuesExp,SaturationValuesExp,xlab="pO2 mmHg",ylab="percent saturation",main="Percent saturation as a Function of pO2",col=c(7),type='o')
# legend("bottomright",legend=c(" "),fill=c(2,4,5,6,7,3),lwd=1,cex=1)


#program the equation for the fraction total of myoglobin. 


myoFrac <- function(oxypress,p50){
  ans <- oxypress/(oxypress+p50)
  return(ans)
}

#set up vector with oxygen pressure values like a freaking baller. 
oxyVals <- seq(1,100)

#This is my function that returns a vector of the myoglobin fraction values, i bet no one else made a  function with a for loop LOL. 

makeFracVals <-function(p50){
  myoVals<-numeric()
  for(i in 1:length(oxyVals)){
    myoVals[i] <- myoFrac(oxyVals[i],p50)
  }
  return(myoVals)
}



plot(oxyVals,makeFracVals(2.4), xlab="pO2 mmHg",ylab="fraction of total myoglobin oxygenated",main="Fraction of Total Myoglobin Oxygenated as a Function of pO2 (#1)",col=c(3),type='o')



plot(oxyVals,makeFracVals(2.4), xlab="pO2 mmHg",ylab="fraction of total myoglobin oxygenated",main="Fraction of Total Myoglobin Oxygenated as a Function of pO2(#2)",col=c(3),type='o')

#This is not a sigmoidal curve, but rather a hyperbolic curve. 

#differnet p50 Values: 1.0, 2.0, 3.0, 4.0, 5.0 
#ADD THOSE LINES BABY. 
lines(oxyVals,makeFracVals(1.0),xlab="pO2 mmHg",ylab="percent saturation of myoglobin",main="Fraction of Total Myoglobin Oxygenated as a Function of pO2 & (p50=1.0) ",col=c(2),type='o')
lines(oxyVals,makeFracVals(2.0),xlab="pO2 mmHg",ylab="percent saturation of myoglobin",main="Fraction of Total Myoglobin Oxygenated as a Function of pO2 & (p50=2.0) ",col=c(4),type='o')
lines(oxyVals,makeFracVals(3.0),xlab="pO2 mmHg",ylab="percent saturation of myoglobin",main="Fraction of Total Myoglobin Oxygenated as a Function of pO2 & (p50=3.0) ",col=c(5),type='o')
lines(oxyVals,makeFracVals(4.0),xlab="pO2 mmHg",ylab="percent saturation of myoglobin",main="Fraction of Total Myoglobin Oxygenated as a Function of pO2 & (p50=4.0) ",col=c(6),type='o')
lines(oxyVals,makeFracVals(5.0),xlab="pO2 mmHg",ylab="percent saturation of myoglobin",main="Fraction of Total Myoglobin Oxygenated as a Function of pO2 & (p50=5.0) ",col=c(7),type='o')

legend("bottomright",legend=c("p50=1.0","p50=2.0","p50=3.0","p50=4.0","p50=5.0","p50=2.4"),fill=c(2,4,5,6,7,3),lwd=1,cex=1)


#LOOK AT THAT SEXY GRAPH. As you increase the p50, you expereince a rightward shift of the curve, and myoglobin affinity is lowered.  



#HEMOGLOBIN LAB PART 2:

filename <- read.csv("Experimental_Data.csv")
#filename

pO2Values <- filename$data_pO2
SaturationValues <- filename$data_Y

#pO2Values
#SaturationValues
#NUMBER 3
plot(pO2Values,SaturationValues, xlab="pO2 mmHg",ylab="fraction of total myoglobin oxygenated",main="Fraction of Total Myoglobin Oxygenated as a Function of pO2 from Experimental Data File",col=c(3),type='o')



filetwo <- read.csv("Temp_data_Exp.csv")
filetwo

pO2_32 <- filetwo$data_pO2_32
Saturation32<- filetwo$data_Y_32


pO2_35 <- filetwo$data_pO2_35
Saturation35<- filetwo$data_Y_35

pO2_38 <- filetwo$data_pO2_38
Saturation38<- filetwo$data_Y_38

pO2_41 <- filetwo$data_pO2_41
Saturation41<- filetwo$data_Y_41

pO2_44 <- filetwo$data_pO2_44
Saturation44<- filetwo$data_Y_44

pO2_47 <- filetwo$data_pO2_47
Saturation47<- filetwo$data_Y_47

pO2_52 <- filetwo$data_pO2_52
Saturation52<- filetwo$data_Y_52

plot(pO2_32,Saturation32, xlab="pO2 mmHg",ylab="fraction of total myoglobin oxygenated",main="Fraction of Total Myoglobin Oxygenated as a Function of pO2 with Temp Data",col=c(1),type='o',xlim=c(2,99),ylim=c(2,99))

lines(pO2_35,Saturation35,xlab="pO2 mmHg",ylab="percent saturation of myoglobin",col=c(2),type='o')

lines(pO2_38,Saturation38,xlab="pO2 mmHg",ylab="percent saturation of myoglobin",col=c(3),type='o')

lines(pO2_41,Saturation41,xlab="pO2 mmHg",ylab="percent saturation of myoglobin",col=c(4),type='o')

lines(pO2_44,Saturation44,xlab="pO2 mmHg",ylab="percent saturation of myoglobin",col=c(5),type='o')

lines(pO2_47,Saturation47,xlab="pO2 mmHg",ylab="percent saturation of myoglobin",col=c(6),type='o')

lines(pO2_52,Saturation52,xlab="pO2 mmHg",ylab="percent saturation of myoglobin",col=c(7),type='o')

legend("bottomright",legend=c("degrees=32","degrees=35","degrees=38","degrees=41","degrees=44","degrees =47", "degrees=52"),fill=c(1,2,3,4,5,6,7),lwd=1,cex=1)

#As you increase in the temperature, there is a right shift in the curves and thus myoglobin affinity is lowered. 

```

